\NeedsTeXFormat{LaTeX2e}
% \ProvidesPackage{customitemize}[2025/04/18 Custom Itemize Environments]

% Define item spacing variables
\newlength{\custitemizeitems}
\newlength{\custitemizeparss}
\newlength{\custitemizetopp}
\newlength{\custitemizepartp}

% Small spacing values
\newcommand{\@setSpacingSmall}{%
  \setlength{\custitemizeitems}{-2pt}%
  \setlength{\custitemizeparss}{0pt}%
  \setlength{\custitemizetopp}{0pt}%
  \setlength{\custitemizepartp}{0pt}%
}

% Medium spacing values
\newcommand{\@setSpacingMedium}{%
  \setlength{\custitemizeitems}{3pt}%
  \setlength{\custitemizeparss}{0pt}%
  \setlength{\custitemizetopp}{3pt}%
  \setlength{\custitemizepartp}{0pt}%
}

% Large spacing values
\newcommand{\@setSpacingLarge}{%
  \setlength{\custitemizeitems}{15pt}%
  \setlength{\custitemizeparss}{5pt}%
  \setlength{\custitemizetopp}{5pt}%
  \setlength{\custitemizepartp}{2pt}%
}

% Compact spacing
\newenvironment{itemizeS}[1][]{%
  \@setSpacingSmall%
  \begingroup%
  \ifx\relax#1\relax\else%
    \csname#1\endcsname%
    % Override beamer font settings when explicit font size is given
    \def\@tempsmall{small}\def\@temptiny{tiny}\def\@tempfootnotesize{footnotesize}\def\@templarge{large}\def\@tempnormalsize{normalsize}%
    \def\@currentfontsize{#1}%
    \ifx\@currentfontsize\@tempsmall\setbeamerfont{itemize/enumerate subbody}{size=\small}\setbeamerfont{itemize/enumerate subsubbody}{size=\small}\fi%
    \ifx\@currentfontsize\@temptiny\setbeamerfont{itemize/enumerate subbody}{size=\tiny}\setbeamerfont{itemize/enumerate subsubbody}{size=\tiny}\fi%
    \ifx\@currentfontsize\@tempfootnotesize\setbeamerfont{itemize/enumerate subbody}{size=\footnotesize}\setbeamerfont{itemize/enumerate subsubbody}{size=\footnotesize}\fi%
    \ifx\@currentfontsize\@templarge\setbeamerfont{itemize/enumerate subbody}{size=\large}\setbeamerfont{itemize/enumerate subsubbody}{size=\large}\fi%
    \ifx\@currentfontsize\@tempnormalsize\setbeamerfont{itemize/enumerate subbody}{size=\normalsize}\setbeamerfont{itemize/enumerate subsubbody}{size=\normalsize}\fi%
  \fi%
  \begin{itemize}%
  \setlength{\itemsep}{\custitemizeitems}%
  \setlength{\parsep}{\custitemizeparss}%
  \setlength{\topsep}{\custitemizetopp}%
  \setlength{\partopsep}{\custitemizepartp}%
}{%
  \end{itemize}%
  \endgroup%
}

% Medium spacing
\newenvironment{itemizeM}[1][]{%
  \@setSpacingMedium%
  \begingroup%
  \ifx\relax#1\relax\else%
    \csname#1\endcsname%
    % Override beamer font settings when explicit font size is given
    \def\@tempsmall{small}\def\@temptiny{tiny}\def\@tempfootnotesize{footnotesize}\def\@templarge{large}\def\@tempnormalsize{normalsize}%
    \def\@currentfontsize{#1}%
    \ifx\@currentfontsize\@tempsmall\setbeamerfont{itemize/enumerate subbody}{size=\small}\setbeamerfont{itemize/enumerate subsubbody}{size=\small}\fi%
    \ifx\@currentfontsize\@temptiny\setbeamerfont{itemize/enumerate subbody}{size=\tiny}\setbeamerfont{itemize/enumerate subsubbody}{size=\tiny}\fi%
    \ifx\@currentfontsize\@tempfootnotesize\setbeamerfont{itemize/enumerate subbody}{size=\footnotesize}\setbeamerfont{itemize/enumerate subsubbody}{size=\footnotesize}\fi%
    \ifx\@currentfontsize\@templarge\setbeamerfont{itemize/enumerate subbody}{size=\large}\setbeamerfont{itemize/enumerate subsubbody}{size=\large}\fi%
    \ifx\@currentfontsize\@tempnormalsize\setbeamerfont{itemize/enumerate subbody}{size=\normalsize}\setbeamerfont{itemize/enumerate subsubbody}{size=\normalsize}\fi%
  \fi%
  \begin{itemize}%
  \setlength{\itemsep}{\custitemizeitems}%
  \setlength{\parsep}{\custitemizeparss}%
  \setlength{\topsep}{\custitemizetopp}%
  \setlength{\partopsep}{\custitemizepartp}%
}{%
  \end{itemize}%
  \endgroup%
}

% Large spacing
\newenvironment{itemizeL}[1][]{%
  \@setSpacingLarge%
  \begingroup%
  \ifx\relax#1\relax\else%
    \csname#1\endcsname%
    % Override beamer font settings when explicit font size is given
    \def\@tempsmall{small}\def\@temptiny{tiny}\def\@tempfootnotesize{footnotesize}\def\@templarge{large}\def\@tempnormalsize{normalsize}%
    \def\@currentfontsize{#1}%
    \ifx\@currentfontsize\@tempsmall\setbeamerfont{itemize/enumerate subbody}{size=\small}\setbeamerfont{itemize/enumerate subsubbody}{size=\small}\fi%
    \ifx\@currentfontsize\@temptiny\setbeamerfont{itemize/enumerate subbody}{size=\tiny}\setbeamerfont{itemize/enumerate subsubbody}{size=\tiny}\fi%
    \ifx\@currentfontsize\@tempfootnotesize\setbeamerfont{itemize/enumerate subbody}{size=\footnotesize}\setbeamerfont{itemize/enumerate subsubbody}{size=\footnotesize}\fi%
    \ifx\@currentfontsize\@templarge\setbeamerfont{itemize/enumerate subbody}{size=\large}\setbeamerfont{itemize/enumerate subsubbody}{size=\large}\fi%
    \ifx\@currentfontsize\@tempnormalsize\setbeamerfont{itemize/enumerate subbody}{size=\normalsize}\setbeamerfont{itemize/enumerate subsubbody}{size=\normalsize}\fi%
  \fi%
  \begin{itemize}%
  \setlength{\itemsep}{\custitemizeitems}%
  \setlength{\parsep}{\custitemizeparss}%
  \setlength{\topsep}{\custitemizetopp}%
  \setlength{\partopsep}{\custitemizepartp}%
}{%
  \end{itemize}%
  \endgroup%
}

% Fill spacing
\newenvironment{itemizeF}[1][]{%
  \begingroup%
  \ifx\relax#1\relax\else%
    \csname#1\endcsname%
    % Override beamer font settings when explicit font size is given
    \def\@tempsmall{small}\def\@temptiny{tiny}\def\@tempfootnotesize{footnotesize}\def\@templarge{large}\def\@tempnormalsize{normalsize}%
    \def\@currentfontsize{#1}%
    \ifx\@currentfontsize\@tempsmall\setbeamerfont{itemize/enumerate subbody}{size=\small}\setbeamerfont{itemize/enumerate subsubbody}{size=\small}\fi%
    \ifx\@currentfontsize\@temptiny\setbeamerfont{itemize/enumerate subbody}{size=\tiny}\setbeamerfont{itemize/enumerate subsubbody}{size=\tiny}\fi%
    \ifx\@currentfontsize\@tempfootnotesize\setbeamerfont{itemize/enumerate subbody}{size=\footnotesize}\setbeamerfont{itemize/enumerate subsubbody}{size=\footnotesize}\fi%
    \ifx\@currentfontsize\@templarge\setbeamerfont{itemize/enumerate subbody}{size=\large}\setbeamerfont{itemize/enumerate subsubbody}{size=\large}\fi%
    \ifx\@currentfontsize\@tempnormalsize\setbeamerfont{itemize/enumerate subbody}{size=\normalsize}\setbeamerfont{itemize/enumerate subsubbody}{size=\normalsize}\fi%
  \fi%
  \begin{itemize}%
  \setlength{\itemsep}{1em plus 1fill}%
}{%
  \end{itemize}%
  \endgroup%
}

% Key-value interface with separate environments for each type
\RequirePackage{keyval}

% Define keys
\define@key{customitemize}{fs}{\def\custom@itemize@fs{#1}}
\define@key{customitemize}{sep}{\def\custom@itemize@sep{#1}}

% Set default values
\def\custom@itemize@fs{}
\def\custom@itemize@sep{M}

% Create separate command for each spacing type
\newcommand{\kitemize@typeS}[1][]{%
  \@setSpacingSmall%
  \begingroup%
  \ifx\relax#1\relax\else%
    \csname#1\endcsname%
    % Override beamer font settings when explicit font size is given
    \def\@tempsmall{small}\def\@temptiny{tiny}\def\@tempfootnotesize{footnotesize}\def\@templarge{large}\def\@tempnormalsize{normalsize}%
    \def\@currentfontsize{#1}%
    \ifx\@currentfontsize\@tempsmall\setbeamerfont{itemize/enumerate subbody}{size=\small}\setbeamerfont{itemize/enumerate subsubbody}{size=\small}\fi%
    \ifx\@currentfontsize\@temptiny\setbeamerfont{itemize/enumerate subbody}{size=\tiny}\setbeamerfont{itemize/enumerate subsubbody}{size=\tiny}\fi%
    \ifx\@currentfontsize\@tempfootnotesize\setbeamerfont{itemize/enumerate subbody}{size=\footnotesize}\setbeamerfont{itemize/enumerate subsubbody}{size=\footnotesize}\fi%
    \ifx\@currentfontsize\@templarge\setbeamerfont{itemize/enumerate subbody}{size=\large}\setbeamerfont{itemize/enumerate subsubbody}{size=\large}\fi%
    \ifx\@currentfontsize\@tempnormalsize\setbeamerfont{itemize/enumerate subbody}{size=\normalsize}\setbeamerfont{itemize/enumerate subsubbody}{size=\normalsize}\fi%
  \fi%
  \begin{itemize}%
  \setlength{\itemsep}{\custitemizeitems}%
  \setlength{\parsep}{\custitemizeparss}%
  \setlength{\topsep}{\custitemizetopp}%
  \setlength{\partopsep}{\custitemizepartp}%
}

\newcommand{\kitemize@typeM}[1][]{%
  \@setSpacingMedium%
  \begingroup%
  \ifx\relax#1\relax\else%
    \csname#1\endcsname%
    % Override beamer font settings when explicit font size is given
    \def\@tempsmall{small}\def\@temptiny{tiny}\def\@tempfootnotesize{footnotesize}\def\@templarge{large}\def\@tempnormalsize{normalsize}%
    \def\@currentfontsize{#1}%
    \ifx\@currentfontsize\@tempsmall\setbeamerfont{itemize/enumerate subbody}{size=\small}\setbeamerfont{itemize/enumerate subsubbody}{size=\small}\fi%
    \ifx\@currentfontsize\@temptiny\setbeamerfont{itemize/enumerate subbody}{size=\tiny}\setbeamerfont{itemize/enumerate subsubbody}{size=\tiny}\fi%
    \ifx\@currentfontsize\@tempfootnotesize\setbeamerfont{itemize/enumerate subbody}{size=\footnotesize}\setbeamerfont{itemize/enumerate subsubbody}{size=\footnotesize}\fi%
    \ifx\@currentfontsize\@templarge\setbeamerfont{itemize/enumerate subbody}{size=\large}\setbeamerfont{itemize/enumerate subsubbody}{size=\large}\fi%
    \ifx\@currentfontsize\@tempnormalsize\setbeamerfont{itemize/enumerate subbody}{size=\normalsize}\setbeamerfont{itemize/enumerate subsubbody}{size=\normalsize}\fi%
  \fi%
  \begin{itemize}%
  \setlength{\itemsep}{\custitemizeitems}%
  \setlength{\parsep}{\custitemizeparss}%
  \setlength{\topsep}{\custitemizetopp}%
  \setlength{\partopsep}{\custitemizepartp}%
}

\newcommand{\kitemize@typeL}[1][]{%
  \@setSpacingLarge%
  \begingroup%
  \ifx\relax#1\relax\else%
    \csname#1\endcsname%
    % Override beamer font settings when explicit font size is given
    \def\@tempsmall{small}\def\@temptiny{tiny}\def\@tempfootnotesize{footnotesize}\def\@templarge{large}\def\@tempnormalsize{normalsize}%
    \def\@currentfontsize{#1}%
    \ifx\@currentfontsize\@tempsmall\setbeamerfont{itemize/enumerate subbody}{size=\small}\setbeamerfont{itemize/enumerate subsubbody}{size=\small}\fi%
    \ifx\@currentfontsize\@temptiny\setbeamerfont{itemize/enumerate subbody}{size=\tiny}\setbeamerfont{itemize/enumerate subsubbody}{size=\tiny}\fi%
    \ifx\@currentfontsize\@tempfootnotesize\setbeamerfont{itemize/enumerate subbody}{size=\footnotesize}\setbeamerfont{itemize/enumerate subsubbody}{size=\footnotesize}\fi%
    \ifx\@currentfontsize\@templarge\setbeamerfont{itemize/enumerate subbody}{size=\large}\setbeamerfont{itemize/enumerate subsubbody}{size=\large}\fi%
    \ifx\@currentfontsize\@tempnormalsize\setbeamerfont{itemize/enumerate subbody}{size=\normalsize}\setbeamerfont{itemize/enumerate subsubbody}{size=\normalsize}\fi%
  \fi%
  \begin{itemize}%
  \setlength{\itemsep}{\custitemizeitems}%
  \setlength{\parsep}{\custitemizeparss}%
  \setlength{\topsep}{\custitemizetopp}%
  \setlength{\partopsep}{\custitemizepartp}%
}

\newcommand{\kitemize@typeF}[1][]{%
  \begingroup%
  \ifx\relax#1\relax\else%
    \csname#1\endcsname%
    % Override beamer font settings when explicit font size is given
    \def\@tempsmall{small}\def\@temptiny{tiny}\def\@tempfootnotesize{footnotesize}\def\@templarge{large}\def\@tempnormalsize{normalsize}%
    \def\@currentfontsize{#1}%
    \ifx\@currentfontsize\@tempsmall\setbeamerfont{itemize/enumerate subbody}{size=\small}\setbeamerfont{itemize/enumerate subsubbody}{size=\small}\fi%
    \ifx\@currentfontsize\@temptiny\setbeamerfont{itemize/enumerate subbody}{size=\tiny}\setbeamerfont{itemize/enumerate subsubbody}{size=\tiny}\fi%
    \ifx\@currentfontsize\@tempfootnotesize\setbeamerfont{itemize/enumerate subbody}{size=\footnotesize}\setbeamerfont{itemize/enumerate subsubbody}{size=\footnotesize}\fi%
    \ifx\@currentfontsize\@templarge\setbeamerfont{itemize/enumerate subbody}{size=\large}\setbeamerfont{itemize/enumerate subsubbody}{size=\large}\fi%
    \ifx\@currentfontsize\@tempnormalsize\setbeamerfont{itemize/enumerate subbody}{size=\normalsize}\setbeamerfont{itemize/enumerate subsubbody}{size=\normalsize}\fi%
  \fi%
  \begin{itemize}%
  \setlength{\itemsep}{1em plus 1fill}%
}

% Common end command for all types
\newcommand{\kitemize@end}{%
  \end{itemize}%
  \endgroup%
}

% Main kitemize environment - no conditionals, just direct command definitions
\def\kitemize{\@ifnextchar[{\kitemize@i}{\kitemize@i[]}}
\def\kitemize@i[#1]{\begingroup\def\@tempa{#1}\expandafter\endgroup\expandafter\kitemize@ii\expandafter{\@tempa}}
\def\kitemize@ii#1{%
  \setkeys{customitemize}{fs=,sep=M,#1}%
  \def\@tempsep{\custom@itemize@sep}%
  \def\@sep@S{S}%
  \def\@sep@L{L}%
  \def\@sep@F{F}%
  \def\@sep@M{M}%
  
  \ifx\@tempsep\@sep@S
    \expandafter\kitemize@typeS\expandafter[\custom@itemize@fs]%
  \else
    \ifx\@tempsep\@sep@L
      \expandafter\kitemize@typeL\expandafter[\custom@itemize@fs]%
    \else
      \ifx\@tempsep\@sep@F
        \expandafter\kitemize@typeF\expandafter[\custom@itemize@fs]%
      \else
        \expandafter\kitemize@typeM\expandafter[\custom@itemize@fs]%
      \fi
    \fi
  \fi
}
\def\endkitemize{\kitemize@end}

\endinput
